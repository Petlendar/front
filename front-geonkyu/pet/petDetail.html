<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>반려동물 상세 정보</title>
  <link rel="stylesheet" href="../css/petDetail.css">
</head>
<body>
  <header class="header">
    <h1>반려동물 상세 정보</h1>
  </header>
  <main class="main-container">
    <section id="pet-detail" class="pet-detail"></section>
  </main>
  <footer class="footer">
    <p>&copy; 2024 PETLENDAR. All rights reserved.</p>
  </footer>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const urlParams = new URLSearchParams(window.location.search);
      const petId = urlParams.get('petId');
      const petDetailContainer = document.getElementById('pet-detail');
      const accessToken = localStorage.getItem('accessToken');

      if (!accessToken) {
        petDetailContainer.innerHTML = '<p>로그인이 필요합니다. 먼저 로그인해 주세요.</p>';
        return;
      }

      if (!petId) {
        petDetailContainer.innerHTML = '<p>유효하지 않은 요청입니다. 반려동물 ID가 필요합니다.</p>';
        return;
      }

      try {
        const response = await fetch(`http://114.70.216.57/pet/api/pet/${petId}`, {
          method: 'GET',
          headers: {
            'Authorization': `Bearer ${accessToken}`,
            'Content-Type': 'application/json',
          },
        });

        const data = await response.json();

        if (data.result.resultCode === 200) {
          const pet = data.body;
          petDetailContainer.innerHTML = `
            <h2>${pet.name}</h2>
            <p><strong>생일:</strong> ${pet.birth}</p>
            <p><strong>주소:</strong> ${pet.address}</p>
            <p><strong>카테고리:</strong> ${pet.category}</p>
            <p><strong>체중:</strong> ${pet.weight} kg</p>
            ${pet.petImage ? `<img src="${pet.petImage.imageUrl}" alt="${pet.name}" class="pet-image">` : ''}
          `;
        } else {
          petDetailContainer.innerHTML = '<p>반려동물 정보를 불러오는 데 실패했습니다.</p>';
        }
      } catch (error) {
        console.error('Error fetching pet details:', error);
        petDetailContainer.innerHTML = '<p>반려동물 정보를 불러오는 중 오류가 발생했습니다.</p>';
      }
    });
  </script>
</body>
</html>
